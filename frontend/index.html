<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù‡Ø±Ù…Ø²Ú¯Ø§Ù† Ø¯Ø±Ø§ÛŒÙˆØ± Ù¾Ø±Ùˆ - Ù†Ù‚Ø´Ù‡ Ø²Ù†Ø¯Ù‡</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #0a0e27; color: white; }
        
        .header {
            background: linear-gradient(135deg, #00A693, #003366);
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #00ff88;
        }
        
        h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .subtitle { color: #aaa; margin-bottom: 20px; }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 166, 147, 0.3);
            transition: all 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            border-color: #00ff88;
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.2);
        }
        
        .card h3 {
            color: #00ff88;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        button {
            background: linear-gradient(135deg, #00A693, #008374);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-size: 1rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 166, 147, 0.4);
        }
        
        .result {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            min-height: 200px;
            overflow-x: auto;
        }
        
        pre {
            white-space: pre-wrap;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-box {
            background: rgba(0, 166, 147, 0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            color: #00ff88;
            margin: 10px 0;
        }
        
        .map-preview {
            height: 300px;
            background: linear-gradient(135deg, rgba(0, 166, 147, 0.2), rgba(0, 51, 102, 0.2));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            margin: 20px 0;
            cursor: pointer;
            border: 2px dashed #00A693;
        }
        
        .map-preview:hover {
            background: linear-gradient(135deg, rgba(0, 166, 147, 0.3), rgba(0, 51, 102, 0.3));
            border-color: #00ff88;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ—ºï¸ Ù‡Ø±Ù…Ø²Ú¯Ø§Ù† Ø¯Ø±Ø§ÛŒÙˆØ± Ù¾Ø±Ùˆ - Ù†Ù‚Ø´Ù‡ Ø²Ù†Ø¯Ù‡</h1>
        <p class="subtitle">Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ø­Ù…Ù„â€ŒÙˆÙ†Ù‚Ù„ Ø¨Ø§ ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ú©Ø§Ù…Ù„ Ù†Ù‚Ø´Ù‡ Neshan</p>
        <p>Backend: http://localhost:3000 | Ú©Ù„ÛŒØ¯ Ù†Ù‚Ø´Ù‡: service.a26822ae...</p>
    </div>
    
    <div class="container">
        <div class="stats-grid" id="stats">
            <!-- Ø¢Ù…Ø§Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
        </div>
        
        <div class="map-preview" onclick="window.open('map.html', '_blank')">
            <div style="font-size: 4rem;">ğŸ—ºï¸</div>
            <div style="font-size: 1.5rem; margin-top: 15px;">Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù†Ù‚Ø´Ù‡ Ø²Ù†Ø¯Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</div>
            <div style="color: #aaa; margin-top: 10px;">Ø±Ø§Ù†Ù†Ø¯Ú¯Ø§Ù† Ø¢Ù†Ù„Ø§ÛŒÙ† â€¢ ØªØ±Ø§ÙÛŒÚ© Ø²Ù†Ø¯Ù‡ â€¢ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ</div>
        </div>
        
        <div class="dashboard">
            <div class="card">
                <h3>ğŸš— Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø§Ù†Ù†Ø¯Ú¯Ø§Ù†</h3>
                <p>Ø«Ø¨Øª Ùˆ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø±Ø§Ù†Ù†Ø¯Ú¯Ø§Ù† Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡</p>
                <div style="margin-top: 15px;">
                    <button onclick="getDrivers()">
                        <span>ğŸ‘ï¸</span> Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø±Ø§Ù†Ù†Ø¯Ú¯Ø§Ù†
                    </button>
                    <button onclick="addDriver()">
                        <span>â•</span> Ø«Ø¨Øª Ø±Ø§Ù†Ù†Ø¯Ù‡ Ø¬Ø¯ÛŒØ¯
                    </button>
                </div>
            </div>
            
            <div class="card">
                <h3>ğŸ“ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ</h3>
                <p>ÛŒØ§ÙØªÙ† Ø¨Ù‡ØªØ±ÛŒÙ† Ù…Ø³ÛŒØ± Ø¯Ø± Ø¨Ù†Ø¯Ø±Ø¹Ø¨Ø§Ø³</p>
                <div style="margin-top: 15px;">
                    <button onclick="findRoute()">
                        <span>ğŸ›£ï¸</span> Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù…Ø³ÛŒØ±
                    </button>
                    <button onclick="getTraffic()">
                        <span>ğŸš¦</span> ÙˆØ¶Ø¹ÛŒØª ØªØ±Ø§ÙÛŒÚ©
                    </button>
                </div>
            </div>
            
            <div class="card">
                <h3>ğŸ” Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ú©Ø§Ù†</h3>
                <p>ÛŒØ§ÙØªÙ† Ù†Ù‚Ø§Ø· Ù…Ù‡Ù… Ø¯Ø± Ø´Ù‡Ø±</p>
                <div style="margin-top: 15px;">
                    <button onclick="searchLocation('Ù…ÛŒØ¯Ø§Ù† Ø´Ù‡Ø¯Ø§')">
                        <span>ğŸ”</span> Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…ÛŒØ¯Ø§Ù†
                    </button>
                    <button onclick="searchLocation('ÙØ±ÙˆØ¯Ú¯Ø§Ù‡')">
                        <span>âœˆï¸</span> Ø¬Ø³ØªØ¬ÙˆÛŒ ÙØ±ÙˆØ¯Ú¯Ø§Ù‡
                    </button>
                </div>
            </div>
            
            <div class="card">
                <h3>âš™ï¸ Ø³ÛŒØ³ØªÙ…</h3>
                <p>Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ Ù†Ø¸Ø§Ø±Øª Ø¨Ø± Ø³ÛŒØ³ØªÙ…</p>
                <div style="margin-top: 15px;">
                    <button onclick="checkHealth()">
                        <span>â¤ï¸</span> Ø³Ù„Ø§Ù…Øª Ø³ÛŒØ³ØªÙ…
                    </button>
                    <button onclick="getStats()">
                        <span>ğŸ“Š</span> Ø¢Ù…Ø§Ø± Ø²Ù†Ø¯Ù‡
                    </button>
                </div>
            </div>
        </div>
        
        <div class="result" id="result">
            <h3>Ø®Ø±ÙˆØ¬ÛŒ Ø³ÛŒØ³ØªÙ…:</h3>
            <p id="result-text">Ø³ÛŒØ³ØªÙ… Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª. ÛŒÚ© Ø¹Ù…Ù„ÛŒØ§Øª Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯...</p>
        </div>
    </div>
    
    <script>
        const API_BASE = 'http://localhost:3000';
        
        // ØªØ§Ø¨Ø¹â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
        async function checkHealth() {
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø³Ù„Ø§Ù…Øª Ø³ÛŒØ³ØªÙ…...');
            try {
                const response = await fetch(`${API_BASE}/api/health`);
                const data = await response.json();
                showResult('âœ… Ø³Ù„Ø§Ù…Øª Ø³ÛŒØ³ØªÙ…', data);
                updateStats();
            } catch (error) {
                showError('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±', error);
            }
        }
        
        async function getDrivers() {
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ø§Ù†Ù†Ø¯Ú¯Ø§Ù†...');
            try {
                const response = await fetch(`${API_BASE}/api/map/drivers`);
                const data = await response.json();
                showResult('ğŸš— Ø±Ø§Ù†Ù†Ø¯Ú¯Ø§Ù† Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡', data);
            } catch (error) {
                showError('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø±Ø§Ù†Ù†Ø¯Ú¯Ø§Ù†', error);
            }
        }
        
        async function getStats() {
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø±...');
            try {
                const response = await fetch(`${API_BASE}/api/stats`);
                const data = await response.json();
                showResult('ğŸ“Š Ø¢Ù…Ø§Ø± Ø³ÛŒØ³ØªÙ…', data);
                updateStatsUI(data);
            } catch (error) {
                showError('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø±', error);
            }
        }
        
        function addDriver() {
            const name = prompt('Ù†Ø§Ù… Ø±Ø§Ù†Ù†Ø¯Ù‡:');
            const phone = prompt('Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†:');
            
            if (!name || !phone) return;
            
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø«Ø¨Øª Ø±Ø§Ù†Ù†Ø¯Ù‡...');
            
            // Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒ API Ø«Ø¨Øª Ø±Ø§Ù†Ù†Ø¯Ù‡ Ø±Ø§ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ú©Ù†ÛŒ
            setTimeout(() => {
                showMessage(`âœ… Ø±Ø§Ù†Ù†Ø¯Ù‡ "${name}" Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯`);
                getDrivers();
            }, 1000);
        }
        
        function findRoute() {
            const origin = prompt('Ù…Ø¨Ø¯Ø£ (Ù…Ø«Ø§Ù„: Ù…Ø±Ú©Ø² Ø´Ù‡Ø±):', 'Ù…Ø±Ú©Ø² Ø¨Ù†Ø¯Ø±Ø¹Ø¨Ø§Ø³');
            const destination = prompt('Ù…Ù‚ØµØ¯ (Ù…Ø«Ø§Ù„: ÙØ±ÙˆØ¯Ú¯Ø§Ù‡):', 'ÙØ±ÙˆØ¯Ú¯Ø§Ù‡ Ø¨Ù†Ø¯Ø±Ø¹Ø¨Ø§Ø³');
            
            if (!origin || !destination) return;
            
            showLoading('Ø¯Ø± Ø­Ø§Ù„ ÛŒØ§ÙØªÙ† Ù…Ø³ÛŒØ±...');
            
            fetch(`${API_BASE}/api/map/route?origin=${encodeURIComponent(origin)}&destination=${encodeURIComponent(destination)}`)
                .then(res => res.json())
                .then(data => showResult('ğŸ“ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ', data))
                .catch(error => showError('Ø®Ø·Ø§ Ø¯Ø± Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ', error));
        }
        
        function getTraffic() {
            showLoading('Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª ØªØ±Ø§ÙÛŒÚ©...');
            fetch(`${API_BASE}/api/map/traffic`)
                .then(res => res.json())
                .then(data => showResult('ğŸš¦ ØªØ±Ø§ÙÛŒÚ© Ø²Ù†Ø¯Ù‡', data))
                .catch(error => showError('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ØªØ±Ø§ÙÛŒÚ©', error));
        }
        
        function searchLocation(query) {
            showLoading(`Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬ÙˆÛŒ "${query}"...`);
            fetch(`${API_BASE}/api/map/search?query=${encodeURIComponent(query)}`)
                .then(res => res.json())
                .then(data => showResult('ğŸ” Ù†ØªØ§ÛŒØ¬ Ø¬Ø³ØªØ¬Ùˆ', data))
                .catch(error => showError('Ø®Ø·Ø§ Ø¯Ø± Ø¬Ø³ØªØ¬Ùˆ', error));
        }
        
        // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ
        function showLoading(message) {
            document.getElementById('result-text').innerHTML = `
                <div style="color: #00A693; font-size: 1.2rem;">
                    ğŸ”„ ${message}
                </div>
            `;
        }
        
        function showResult(title, data) {
            let html = `<h4 style="color: #00ff88">${title}</h4>`;
            html += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            document.getElementById('result-text').innerHTML = html;
        }
        
        function showError(title, error) {
            document.getElementById('result-text').innerHTML = `
                <h4 style="color: #ff6b6b">${title}</h4>
                <pre style="color: #ff9999">${error.message || error}</pre>
            `;
        }
        
        function showMessage(message) {
            document.getElementById('result-text').innerHTML = `
                <div style="color: #00ff88; font-size: 1.2rem;">
                    ${message}
                </div>
            `;
        }
        
        function updateStatsUI(data) {
            const stats = data.stats || {};
            const container = document.getElementById('stats');
            
            container.innerHTML = `
                <div class="stat-box">
                    <div>Ø±Ø§Ù†Ù†Ø¯Ú¯Ø§Ù†</div>
                    <div class="stat-value">${stats.drivers || 0}</div>
                    <div>Ø«Ø¨Øª Ø´Ø¯Ù‡</div>
                </div>
                <div class="stat-box">
                    <div>Ø³ÙØ±Ù‡Ø§</div>
                    <div class="stat-value">${stats.trips || 0}</div>
                    <div>Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡</div>
                </div>
                <div class="stat-box">
                    <div>Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù†Ù‚Ø´Ù‡</div>
                    <div class="stat-value">${stats.mapRequests || 0}</div>
                    <div>Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø²Ù†Ø¯Ù‡</div>
                </div>
                <div class="stat-box">
                    <div>ÙˆØ¶Ø¹ÛŒØª</div>
                    <div class="stat-value">âœ…</div>
                    <div>${stats.system?.backend || 'ÙØ¹Ø§Ù„'}</div>
                </div>
            `;
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        window.onload = function() {
            checkHealth();
        };
    </script>
</body>
</html>
